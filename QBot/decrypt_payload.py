import base64
import hashlib
from arc4 import ARC4
from binascii import unhexlify

HARDCODED_SALT = b"jHxastDcds)oMc=jvh7wdUhxcsdt2"

def decrypt_payload(encrypted_blob):
	b64_decoded = base64.b64decode(encrypted_blob)
	decryption_key = b64_decoded[:0x10] + HARDCODED_SALT
	sha1hash = hashlib.sha1()
	sha1hash.update(decryption_key)
	decryption_key_hash = sha1hash.digest()
	rc4 = ARC4(decryption_key_hash)
	return rc4.decrypt(b64_decoded[0x10:])

# print(decrypt_payload("QdpiSyqqcYPOwSqzTdj3lRdZW2MW+cM1WwVC6pJKqe8lGxIJLvJjUAdU8Dse0HNQoA=="))
